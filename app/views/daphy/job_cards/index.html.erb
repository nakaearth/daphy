<%= flash[:notice] %>
<hr/>
<div class='job_board' id='job_board'>
  <div class='job_list' id='Todo'>
    TODO:<%= render partial: 'job_card', collection:  @todos %>
  </div>
  <div class='job_list' id='Doing'>
    DOING:<%= render partial: 'job_card', collection: @doings %>
  </div>
  <div class='job_list' id='Done'>
    DONE:<%= render partial: 'job_card', collection: @dones %>
  </div>
</div>
<script type='text/javascript'>
  $("#todo_list").droppable({
    drop: function(event, ui) {
      $(this)
        .html(ui.draggable.text() +  "ドロップされました!" );
     }
  });

  // $("#doing_list").droppable({
  $(".job_list").droppable({
    drop: function(event, ui) {
      $(this).html(
        ui.draggable.text() + 'がドロップされました。<br />');
      $.ajax({
        type:"PATCH",
        url:"/daphy/job_cards/"+ ui.draggable.attr('id')  + "/change_type?type=Doing",
        contentType:'application/json',
        dataType:'json',

        // In case that an error happens, capture it and show the details.
        error:function (xhr, msg, error) {
          alert(msg + ": " + error + ui.draggable.attr('id'));
        }
      })
    }
  });

  $("#done_list").droppable({
    drop: function(event, ui) {
      alert('drop');
    }
  });
</script>
