<%= flash[:notice] %>
<div class='job_board' id='job_board'>
  <div class='job_list' id='Todo'>
    TODO:<%= render partial: 'job_card', collection:  @todos %>
  </div>
  <div class='job_list' id='Doing'>
    DOING:<%= render partial: 'job_card', collection: @doings %>
  </div>
  <div class='job_list' id='Done'>
    DONE:<%= render partial: 'job_card', collection: @dones %>
  </div>
</div>
<script type='text/javascript'>
  $("#Todo").droppable({
    drop: function(event, ui) {
      $.ajax({
        type:"PATCH",
        url:"/daphy/job_cards/"+ ui.draggable.attr('id')  + "/change_type?type=Todo",
       contentType:'application/json',
        dataType:'json',

        error:function (xhr, msg, error) {
          alert(msg + ": " + error + ui.draggable.attr('id'));
        }
      });
      ui.draggable.effect('highlight', '', 2000);
    }
  });

  $("#Doing").droppable({
    drop: function(event, ui) {
      $.ajax({
        type:"PATCH",
        url:"/daphy/job_cards/"+ ui.draggable.attr('id')  + "/change_type?type=Doing",
        contentType:'application/json',
        dataType:'json',

        error:function (xhr, msg, error) {
          alert(msg + ": " + error + ui.draggable.attr('id'));
        }
      })
      ui.draggable.effect('highlight', '', 2000);
    }
  });

  $("#Done").droppable({
    drop: function(event, ui) {
      $.ajax({
        type:"PATCH",
        url:"/daphy/job_cards/"+ ui.draggable.attr('id')  + "/change_type?type=Done",
        contentType:'application/json',
        dataType:'json',

        error:function (xhr, msg, error) {
          alert(msg + ": " + error + ui.draggable.attr('id'));
        }
      })
      ui.draggable.effect('highlight', '', 2000);
    }
  });
</script>
